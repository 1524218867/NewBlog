(function(){"use strict";var t={6365:function(t,e,i){var a=i(8451),s=i.n(a),r=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("transition",{attrs:{name:"fade"}},[t.isLoading?e("Loader",{attrs:{visible:t.isLoading}}):t._e()],1),t.isView?e("router-view",{staticClass:"view"}):t._e()],1)},o=[],l=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"scene"},[t._m(0)]):t._e()},n=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"loader"},[e("div",{staticClass:"box box0"},[e("div")]),e("div",{staticClass:"box box1"},[e("div")]),e("div",{staticClass:"box box2"},[e("div")]),e("div",{staticClass:"box box3"},[e("div")]),e("div",{staticClass:"box box4"},[e("div")]),e("div",{staticClass:"box box5"},[e("div")]),e("div",{staticClass:"box box6"},[e("div")]),e("div",{staticClass:"box box7"},[e("div")]),e("div",{staticClass:"ground"},[e("div")])])}],c={props:{visible:{type:Boolean,default:!1}}},d=c,u=i(1656),g=(0,u.A)(d,l,n,!1,null,"99ce25fe",null),h=g.exports,m=i(7222),p={data(){return{isLoading:!1,isView:!1}},components:{Loader:h},watch:{$route(t){this.onRouteChange(t)}},computed:{...(0,m.aH)(["hasVisitedHome"])},methods:{...(0,m.i0)(["markVisitedHome"]),onRouteChange(t){"Home"!==t.name||this.hasVisitedHome?(this.isLoading=!1,this.isView=!0):(this.isLoading=!0,this.isView=!1,setTimeout((()=>{this.isLoading=!1,this.markVisitedHome()}),3e3),setTimeout((()=>{this.isView=!0}),4e3))}},mounted(){this.onRouteChange(this.$route)}},f=p,v=(0,u.A)(f,r,o,!1,null,"00d1b716",null),C=v.exports,w=i(6648),y=i(2674);w["default"].use(m.Ay);const _=new m.Ay.Store({state:{sharedData:null,hasVisitedHome:!1,user:{token:null,details:{}},favorites:[],userId:null,articleFrom:null},mutations:{setSharedData(t,e){t.sharedData=e},setArticleFrom(t,e){t.articleFrom=e},setUser(t,{token:e,details:i}){t.user.token=e,t.user.details=i},deleteUser(t){t.user={token:null,details:{}}},setHasVisitedHome(t,e){t.hasVisitedHome=e},updateUsername(t,e){t.user.details.username=e},setFavorites(t,e){t.favorites=e}},actions:{updateSharedData({commit:t},e){t("setSharedData",e)},updateUser({commit:t},{token:e,details:i}){t("setUser",{token:e,details:i})},logout({commit:t}){t("deleteUser")},markVisitedHome({commit:t}){t("setHasVisitedHome",!0)},resetVisitedHome({commit:t}){t("setHasVisitedHome",!1)},async VuexloadFavorites({commit:t}){const e=localStorage.getItem("token");if(e)try{const i=await y.A.get("/api/user",{headers:{Authorization:`Bearer ${e}`}}),a=i.data._id,s=await y.A.get(`/api/favorites/${a}`),r=s.data;t("setFavorites",r)}catch(i){console.error("加载收藏失败:",i)}}},getters:{isLoggedIn(t){return!!t.user.token},getUser(t){return t.user.details},hasVisitedHome:t=>t.hasVisitedHome,getFavorites:t=>t.favorites,getUserId:t=>t.userId}});var b=_,A=(i(6099),i(6051)),k=i.n(A),I=i(79),x=i.n(I),S=function(){var t=this,e=t._self._c;return e("div",{staticClass:"PackageContent",on:{click:t.handleClickIndexContent}},[e("div",{staticClass:"header"},[e("div",{staticClass:"LogoAndMenu"},[e("div",{staticClass:"logo-menu-container"},[t._m(0),e("ul",{staticClass:"menu"},[e("li",{class:{active:"home"===t.activeSection}},[e("router-link",{attrs:{to:t.getPath(0)},nativeOn:{click:function(e){return t.setActive("home")}}},[e("span",[t._v("首页")])])],1),e("li",{class:{active:"discover"===t.activeSection}},[e("router-link",{attrs:{to:t.getPath(1)},nativeOn:{click:function(e){return t.setActive("discover")}}},[e("span",[t._v("发现")])])],1),e("li",{class:{active:"create"===t.activeSection}},[t.isDisabled?e("span",[t._v("创作")]):[e("router-link",{attrs:{to:t.getPath(2)},nativeOn:{click:function(e){return t.setActive("create")}}},[e("span",[t._v("创作")])])]],2),e("li",{class:{active:"my"===t.activeSection}},[e("router-link",{attrs:{to:t.getPath(3)},nativeOn:{click:function(e){return t.setActive("my")}}},[e("span",[t._v("我的")])])],1)])]),e("div",{staticClass:"right-container"},[e("div",{staticClass:"InputContainer",class:{expanded:t.isSearchExpanded},on:{click:function(e){return e.stopPropagation(),t.toggleSearch.apply(null,arguments)}}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],staticClass:"input",attrs:{placeholder:"Search",id:"input",name:"text",type:"text"},domProps:{value:t.keyword},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchArticles.apply(null,arguments)},input:[function(e){e.target.composing||(t.keyword=e.target.value)},t.onInputChange],focus:t.highlightButton,blur:t.resetButton}}),e("label",{staticClass:"labelforsearch",attrs:{for:"input"},on:{click:function(e){return e.stopPropagation(),t.handleSearchClick.apply(null,arguments)}}},[e("svg",{staticClass:"searchIcon",attrs:{viewBox:"0 0 512 512"}},[e("path",{attrs:{d:"M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"}})])]),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.SouSuoContent,expression:"SouSuoContent"}]},[e("svg",{staticClass:"icon",attrs:{t:"1734760992680",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4142",width:"15",height:"15"},on:{click:t.CloseSearch}},[e("path",{attrs:{d:"M593.976284 490.054855l359.392196 359.549238a74.516756 74.516756 0 1 1-105.454166 105.454166L488.443597 595.587542l-359.470718 359.470717a74.438235 74.438235 0 0 1-105.532687 0 74.595278 74.595278 0 0 1 0-105.454166L382.910909 490.054855 23.440192 130.584137A74.595278 74.595278 0 0 1 128.972879 25.129971L488.443597 384.600688 847.914314 25.129971a74.595278 74.595278 0 1 1 105.454166 105.454166L593.976284 490.054855z",fill:"#2C2F46","p-id":"4143"}})]),t._l(t.SouSuoarticles,(function(i){return e("li",{key:i._id},[e("router-link",{staticClass:"search-result-item",attrs:{to:{name:"Article",params:{id:i._id}}}},[e("h3",{domProps:{innerHTML:t._s(i.title)}}),e("p",{domProps:{innerHTML:t._s(i.BriefIntroduction)}})])],1)}))],2)]),e("label",{staticClass:"popup",on:{click:function(t){t.preventDefault()}}},[e("div",{staticClass:"burger",attrs:{tabindex:"0"},on:{click:function(e){return e.preventDefault(),t.openPopup.apply(null,arguments)}}},[e("svg",{staticClass:"icon",attrs:{t:"1731742925320",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4265",width:"20",height:"200"}},[e("path",{attrs:{d:"M61.44 238.933333h901.12c27.306667 0 47.786667-20.48 47.786667-47.786666 0-27.306667-20.48-47.786667-47.786667-47.786667H61.44C34.133333 143.36 13.653333 163.84 13.653333 191.146667 13.653333 218.453333 34.133333 238.933333 61.44 238.933333z m901.12 225.28H61.44C34.133333 464.213333 13.653333 484.693333 13.653333 512s20.48 47.786667 47.786667 47.786667h901.12c27.306667 0 47.786667-20.48 47.786667-47.786667s-23.893333-47.786667-47.786667-47.786667z m0 320.853334H61.44c-27.306667 0-47.786667 20.48-47.786667 47.786666 0 27.306667 20.48 47.786667 47.786667 47.786667h901.12c27.306667 0 47.786667-20.48 47.786667-47.786667 0-27.306667-23.893333-47.786667-47.786667-47.786666z","p-id":"4266",fill:"#ffffff"}})])]),e("nav",{directives:[{name:"show",rawName:"v-show",value:t.isPopupVisible,expression:"isPopupVisible"}],staticClass:"popup-window",on:{click:function(e){return e.stopPropagation(),t.handlePopupClick.apply(null,arguments)}}},[e("ul",[e("li",[e("router-link",{attrs:{to:t.getPath(0)},nativeOn:{click:function(e){return t.setActive("home")}}},[e("button",{class:{active:"home"===t.activeSection}},[e("svg",{staticClass:"icon",attrs:{t:"1731745400798",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7089",width:"12",height:"12"}},[e("path",{attrs:{d:"M854 512.9c-20.9 0-37.7 16.9-37.7 37.7v240.6c0 85.6-69.6 155.2-155.2 155.2H362.9c-85.6 0-155.2-69.6-155.2-155.2V550.6c0-20.9-16.9-37.7-37.7-37.7s-37.7 16.9-37.7 37.7v240.6c0 127.2 103.5 230.7 230.7 230.7h298.1c127.2 0 230.7-103.5 230.7-230.7V550.6c0-20.8-16.9-37.7-37.8-37.7zM1012.2 430L596.7 35.9c-47.5-45.1-121.9-45.1-169.5 0L11.8 430c-15.1 14.3-15.8 38.2-1.4 53.4 14.4 15.1 38.2 15.8 53.4 1.4L479.2 90.6c18.4-17.4 47.2-17.4 65.5 0l415.5 394.1c7.3 6.9 16.6 10.4 26 10.4 10 0 20-4 27.4-11.8 14.4-15.1 13.8-39-1.4-53.3z","p-id":"7090"}})]),e("span",[t._v("首页")])])])],1),e("li",[e("router-link",{attrs:{to:t.getPath(1)},nativeOn:{click:function(e){return t.setActive("discover")}}},[e("button",{class:{active:"discover"===t.activeSection}},[e("svg",{staticClass:"icon",attrs:{t:"1731747976102",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9138",width:"14",height:"14"}},[e("path",{attrs:{d:"M597.7 566.2m-352.5 0a352.5 352.5 0 1 0 705 0 352.5 352.5 0 1 0-705 0Z","p-id":"9139"}}),e("path",{attrs:{d:"M242.7 782.1c5.4 5.4 10.9 10.5 16.5 15.5 19.8-3.6 42.9-10.9 68.7-22.1-82.9-58.4-137.2-154.8-154.8-263.6 0-177.7 144.5-322.2 322.2-322.2 108.2 0 204 53.6 262.5 135.6 11-25.9 18-49.6 21-69.7-4.3-4.7-8.7-9.4-13.2-13.9-35.1-35.1-76-62.6-121.5-81.9-47.1-19.9-97.2-30-148.8-30-51.6 0-101.6 10.1-148.8 30-45.5 19.3-86.4 46.8-121.5 81.9-35.1 35.1-62.6 76-81.9 121.5-19.9 47.1-30 97.2-30 148.8 0 51.6 10.1 101.6 30 148.8 19.4 45.3 47 86.2 82 121.3zM867.5 405.5c-9.8 21.2-21.5 43-34.9 65.2 1.7 13.5 2.6 27.2 2.6 41.1C835.2 689.5 690.7 834 513 834c-13.6 0-26.9-0.9-40.1-2.5-23.2 14.1-46 26.4-68.1 36.7-4.6 2.1-9.1 4.1-13.6 6 39.1 13.1 80 19.8 121.8 19.8 51.6 0 101.6-10.1 148.8-30 45.5-19.3 86.4-46.8 121.5-81.9 35.1-35.1 62.6-76 81.9-121.5 19.9-47.1 30-97.2 30-148.8 0-42.3-6.8-83.7-20.3-123.2-2.3 5.6-4.8 11.2-7.4 16.9z","p-id":"9140"}}),e("path",{attrs:{d:"M849.3 174.2c-15.2-15.2-43.8-32.6-93.5-29.2-24.7 1.7-52.4 8.3-82.5 19.7 25 11.5 48.5 25.7 70.3 42.2 9.1-1.6 17.5-2.4 25-2.4 17.3 0 30.3 4.1 38.3 12 20.6 20.6 14.4 74.8-16.4 141.4-36.4 78.7-101.7 167.3-183.9 249.5C460.1 754.1 323.2 819.8 254 819.8c-17.3 0-30.3-4.1-38.3-12-11.9-11.9-15.1-35.3-8.9-67.1-16.3-21.8-30.2-45.2-41.6-70.1-12.2 31.5-19.2 60.4-21 86.1-3.5 49.7 13.9 78.3 29.2 93.5 13.9 13.9 38.9 29.6 81 29.6 4 0 8.2-0.1 12.5-0.4 33.5-2.3 72.3-13.6 115.4-33.5C467.3 806.6 562 737 649.1 650S805.7 468.2 845 383.2c19.9-43.1 31.2-81.9 33.5-115.4 3.5-49.8-13.9-78.4-29.2-93.6z",fill:"#000002","p-id":"9141"}}),e("path",{attrs:{d:"M491.022975 310.036021a30 30 0 1 0 42.425667-42.427147 30 30 0 1 0-42.425667 42.427147Z",fill:"#000002","p-id":"9142"}}),e("path",{attrs:{d:"M267.537509 533.397692a30 30 0 1 0 42.425666-42.427148 30 30 0 1 0-42.425666 42.427148Z",fill:"#000002","p-id":"9143"}}),e("path",{attrs:{d:"M477.9 477.3c-7.6 7.6-16.4 13.4-26.2 17.4-9.5 3.9-19.5 5.8-29.8 5.8s-20.3-2-29.8-5.8c-7.7-3.1-11.4-11.9-8.3-19.5 3.1-7.7 11.9-11.4 19.5-8.3 5.9 2.4 12.1 3.6 18.5 3.6s12.6-1.2 18.5-3.6c6.1-2.5 11.6-6.1 16.3-10.8 4.7-4.7 8.3-10.2 10.8-16.3 2.4-5.9 3.6-12.1 3.6-18.5s-1.2-12.6-3.6-18.5c-3.1-7.7 0.6-16.4 8.3-19.5 7.7-3.1 16.4 0.6 19.5 8.3 3.9 9.5 5.8 19.5 5.8 29.8s-2 20.3-5.8 29.8c-3.9 9.7-9.7 18.5-17.3 26.1z",fill:"#000002","p-id":"9144"}})]),e("span",[t._v("发现")])])])],1),e("li",[t.isDisabled?e("div",{on:{click:function(e){return t.Indexpublish()}}},[e("button",{class:{active:"create"===t.activeSection}},[e("svg",{staticClass:"icon",attrs:{t:"1731748751506",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"10213",width:"14",height:"14"}},[e("path",{attrs:{d:"M434.631111 903.395556c-18.887111 0-34.133333-15.246222-34.133333-34.133334V672.768c0-7.850667 2.730667-15.587556 7.736889-21.617778l410.510222-500.280889c9.671111-11.832889 26.055111-15.701333 40.049778-9.557333s22.186667 20.821333 20.138666 35.953778l-93.411555 664.917333c-1.479111 10.922667-8.305778 20.48-17.976889 25.486222-9.784889 5.12-21.390222 5.12-31.288889 0.113778l-213.105778-108.430222c-16.839111-8.533333-23.438222-29.127111-14.904889-45.852445 8.533333-16.839111 29.127111-23.438222 45.852445-14.904888l170.552889 86.812444 69.859555-497.208889L468.764444 685.056V869.262222c0 18.887111-15.36 34.133333-34.133333 34.133334z","p-id":"10214"}}),e("path",{attrs:{d:"M331.776 659.911111c-5.233778 0-10.581333-1.251556-15.587556-3.754667l-174.08-89.884444c-11.264-5.802667-18.432-17.408-18.432-30.151111-0.113778-12.743111 6.940444-24.348444 18.204445-30.378667l687.331555-363.406222c16.611556-8.760889 37.319111-2.389333 46.08 14.222222 8.760889 16.611556 2.389333 37.319111-14.222222 46.08L231.424 535.552l116.053333 59.960889c16.725333 8.647111 23.324444 29.240889 14.677334 45.966222-6.030222 11.719111-17.976889 18.432-30.378667 18.432z","p-id":"10215"}})]),e("span",[t._v("创作")])])]):e("router-link",{attrs:{to:t.getPath(2)},nativeOn:{click:function(e){return t.setActive("create")}}},[e("button",{class:{active:"create"===t.activeSection}},[e("svg",{staticClass:"icon",attrs:{t:"1731748751506",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"10213",width:"14",height:"14"}},[e("path",{attrs:{d:"M434.631111 903.395556c-18.887111 0-34.133333-15.246222-34.133333-34.133334V672.768c0-7.850667 2.730667-15.587556 7.736889-21.617778l410.510222-500.280889c9.671111-11.832889 26.055111-15.701333 40.049778-9.557333s22.186667 20.821333 20.138666 35.953778l-93.411555 664.917333c-1.479111 10.922667-8.305778 20.48-17.976889 25.486222-9.784889 5.12-21.390222 5.12-31.288889 0.113778l-213.105778-108.430222c-16.839111-8.533333-23.438222-29.127111-14.904889-45.852445 8.533333-16.839111 29.127111-23.438222 45.852445-14.904888l170.552889 86.812444 69.859555-497.208889L468.764444 685.056V869.262222c0 18.887111-15.36 34.133333-34.133333 34.133334z","p-id":"10214"}}),e("path",{attrs:{d:"M331.776 659.911111c-5.233778 0-10.581333-1.251556-15.587556-3.754667l-174.08-89.884444c-11.264-5.802667-18.432-17.408-18.432-30.151111-0.113778-12.743111 6.940444-24.348444 18.204445-30.378667l687.331555-363.406222c16.611556-8.760889 37.319111-2.389333 46.08 14.222222 8.760889 16.611556 2.389333 37.319111-14.222222 46.08L231.424 535.552l116.053333 59.960889c16.725333 8.647111 23.324444 29.240889 14.677334 45.966222-6.030222 11.719111-17.976889 18.432-30.378667 18.432z","p-id":"10215"}})]),e("span",[t._v("创作")])])])],1),t.isDisabled?e("li",[e("router-link",{attrs:{to:t.getPath(4)},nativeOn:{click:function(e){return t.setActive("login")}}},[e("button",{class:{active:"login"===t.activeSection}},[e("svg",{staticClass:"icon",attrs:{t:"1733543439950",viewBox:"0 0 1084 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8145",width:"14",height:"14"}},[e("path",{attrs:{d:"M655.380078 298.927686a34.354196 34.354196 0 0 1 0-48.268549 33.731765 33.731765 0 0 1 47.947295 0l233.773176 235.52c7.027451 7.087686 10.039216 16.524549 9.59749 25.820863 0.461804 9.296314-2.549961 18.733176-9.59749 25.86102l-233.773176 235.52a33.731765 33.731765 0 0 1-47.947295 0 34.374275 34.374275 0 0 1 0-48.288628L833.054118 546.133333H33.872314C15.199373 546.133333 0 530.873725 0 512c0-18.833569 15.179294-34.133333 33.872314-34.133333H833.054118l-177.653961-178.938981zM948.725961 1024H271.058824c-74.852392 0-135.529412-61.138824-135.529412-136.533333v-136.533334h67.764706v136.533334c0 37.707294 30.33851 68.266667 67.764706 68.266666h677.647058c37.426196 0 67.764706-30.579451 67.764706-68.266666V136.533333c0-37.707294-30.33851-68.266667-67.764706-68.266666H271.058824c-37.426196 0-67.764706 30.559373-67.764706 68.266666v136.533334H135.529412V136.533333C135.529412 61.138824 196.206431 0 271.058824 0h677.647058C1023.558275 0 1084.235294 61.138824 1084.235294 136.533333v750.933334c0 75.39451-60.67702 136.533333-135.529412 136.533333z","p-id":"8146"}})]),e("span",[t._v("登录")])])])],1):e("li",[e("router-link",{attrs:{to:t.getPath(3)},nativeOn:{click:function(e){return t.setActive("my")}}},[e("button",{class:{active:"my"===t.activeSection}},[e("svg",{staticClass:"icon",attrs:{t:"1731814009258",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2391",width:"14",height:"14"}},[e("path",{attrs:{d:"M512.451579 545.507144c-148.479097 0-269.140942-120.842477-269.140942-269.140942S363.972482 7.22526 512.451579 7.22526s269.140942 120.842477 269.140942 269.140942-120.661845 269.140942-269.140942 269.140942z m0-477.589698c-114.881637 0-208.448756 93.567119-208.448757 208.448756s93.567119 208.448756 208.448757 208.448757S720.900335 391.247839 720.900335 276.366202 627.333216 67.917446 512.451579 67.917446zM896.654789 1016.232845H128.248368c-47.506086 0-85.980596-38.655142-85.980596-85.980596v-58.163344l1.806315-5.057683c57.802081-160.220145 250.355265-272.211678 468.377492-272.211677S923.026989 706.811078 980.82907 867.031222l1.806315 5.057683V930.252249c0 47.506086-38.655142 85.980596-85.980596 85.980596zM103.140589 882.926795V930.252249c0 13.908626 11.379785 25.288411 25.288411 25.288411h768.225789c13.908626 0 25.288411-11.379785 25.288411-25.288411v-47.506086C870.463221 748.717587 703.017816 655.692362 512.451579 655.692362S154.439936 748.717587 103.140589 882.926795z","p-id":"2392"}})]),e("span",[t._v("我的")])])])],1)])])])])])]),e("div",{staticClass:"main-container"},[e("div",{staticClass:"content-wrapper"},[e("router-view",{key:t.$route.fullPath,attrs:{getImageUrl:t.getImageUrl,lastViewedArticleZi:t.lastViewedArticle},on:{themeChanged:t.updateTheme,"call-parent":t.logout}})],1)])])},B=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"logo"},[e("img",{attrs:{src:i(3153),alt:"Logo"}}),e("span",[t._v("云端轻语")])])}],$=(i(6948),{data(){return{articles:[],filteredArticles:[],latestArticle:{},isDisabled:!1,activeSection:"home",LoginActive:null,currentTheme:"light",DisplayContinueReading:!1,viewedArticles:[],lastViewedArticle:null,noArticlesMessage:!1,scrollPosition:0,maxScrollPosition:0,JingDuTiao:0,isPopupVisible:!1,keyword:"",isButtonHighlighted:!1,SouSuoarticles:[],SouSuoContent:!1,isSearchExpanded:!1,themes:{light:{"--primary-color":"#3498db","--ZiBaiBgc":"#f8f9ff","--ActiveBgc":"#f7f7f8","--background-color":"#ffffff","--Border":" #f0f1fb","--text-color":"#000000","--active-background-color":"#1988fa","--article-card-background-color":" #f5f5f5","--Business-card-gradient":"linear-gradient(to right, #1988fa 0%, #33c4f9 50%, #00f2fe 100%)"},dark:{"--primary-color":"#e74c3c","--ActiveBgc":"#1a1a1a","--ZiBaiBgc":"#1f1f1f","--background-color":"#000000","--Border":" #2c2c2c","--text-color":"#ecf0f1","--active-background-color":"#015aea","--article-card-background-color":" #212121","--Business-card-gradient":"linear-gradient(to right, #012a63, #015aea, #4d9ef7)"}}}},components:{},computed:{...(0,m.L8)(["isLoggedIn","getUser"]),...(0,m.aH)(["favorites"]),isPublishPage(){return"/Index/Content"===this.$route.path},isUserPage(){return"/Index/User"===this.$route.path}},watch:{$route:{handler(t){t.path.includes("/Index/Home")?this.activeSection="home":t.path.includes("/Index/Discover")?this.activeSection="discover":t.path.includes("/Index/Create")?this.activeSection="create":t.path.includes("/Index/My")&&(this.activeSection="my")},immediate:!0}},created(){const t=localStorage.getItem("authToken");t&&this.$store.dispatch("updateUser",{token:t,details:{}})},methods:{...(0,m.i0)(["logout","VuexloadFavorites"]),goToRegister(){this.$router.push("/Login")},openPopup(t){t.stopPropagation(),this.isPopupVisible=!this.isPopupVisible},handleClickIndexContent(t){const e=t.target.closest(".popup-window");!e&&this.isPopupVisible&&(this.isPopupVisible=!1)},handlePopupClick(t){t.stopPropagation()},async logout(){try{await this.$store.dispatch("logout"),localStorage.removeItem("token"),I.Notification.success({title:"退出登录成功",message:"您已成功退出登录。",duration:3e3}),this.$router.push("/Login")}catch(t){I.Notification.error({title:"退出登录失败",message:"退出登录过程中出现错误，请稍后重试。",duration:3e3}),console.error("Error:",t)}},getImageUrl(t){return`http://localhost:3000/uploads/${t}`},async fetchArticles(){try{const t=await y.A.get("/api/articles");this.articles=t.data,this.filteredArticles=this.articles,this.latestArticle=this.articles.length>0?this.articles[this.articles.length-1]:{}}catch(t){console.error("Error fetching articles:",t)}},async fetchViewedArticles(){if(null!=localStorage.getItem("token")){this.DisplayContinueReading=!0;try{const t=await y.A.get("/api/user/viewed-articles",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(this.viewedArticles=t.data,0===this.viewedArticles.length)return this.noArticlesMessage=!0,void(this.lastViewedArticle=null);const e=[...this.viewedArticles].sort(((t,e)=>new Date(e.lastViewedAt)-new Date(t.lastViewedAt))),i=e.filter((t=>this.calculateProgress(t.scrollPosition,t.maxScrollPosition)<100));i.length>0?(this.lastViewedArticle=i[0],this.noArticlesMessage=!1):(this.lastViewedArticle=e[0],this.noArticlesMessage=!1),this.lastViewedArticle?this.JingDuTiao=this.calculateProgress(this.lastViewedArticle.scrollPosition,this.lastViewedArticle.maxScrollPosition):this.JingDuTiao=0}catch(t){console.error("Error fetching viewed articles:",t),this.noArticlesMessage=!0}}},calculateProgress(t,e){if(0===e)return 0;const i=t/e*100;return Math.min(i,100)},setActive(t){this.activeSection=t},LoginActiveCLick(t){this.LoginActive=t},getPath(t){const e={0:"/Index/Home",1:"/Index/Discover",2:"/Index/Create",3:"/Index/My",4:"/Login"};return e[t]||"/Index/Home"},setActiveSection(){if(this.$route.matched.length>0)return;const t=this.activeSection;let e="";switch(t){case"home":e="/Index/Home";break;case"discover":e="/Index/Discover";break;case"create":e="/Index/Create";break;case"my":e="/Index/My";break;default:e="/Index/Home"}this.$router.push(e)},toggleTheme(){this.currentTheme="light"===this.currentTheme?"dark":"light",this.updateTheme(this.currentTheme),localStorage.setItem("theme",this.currentTheme)},updateTheme(t){this.currentTheme=t;const e=this.themes[t];for(const i in e)document.documentElement.style.setProperty(i,e[i]);localStorage.setItem("theme",t)},Indexpublish(){this.$notify({title:"警告",message:"请先登录",type:"warning"})},async searchArticles(){if(!this.keyword)return this.message="请输入关键词进行搜索",void I.Notification.info({title:"注意",message:"请输入关键词进行搜索",duration:3e3});try{const t=await fetch(`/api/articles/search?keyword=${encodeURIComponent(this.keyword)}`);if(t.ok){const e=await t.json();e.length>0?(this.SouSuoarticles=e.map((t=>({...t,title:this.highlightKeyword(t.title),BriefIntroduction:this.highlightKeyword(t.BriefIntroduction)}))),this.SouSuoContent=!0,this.message=""):(this.message="没有找到相关的文章",this.SouSuoContent=!1)}else 404===t.status?(this.message="没有找到相关的文章",this.SouSuoContent=!1,I.Notification.error({title:"提示",message:"没有找到相关的文章",duration:3e3})):(this.message="服务器出错，请稍后再试",I.Notification.error({title:"错误",message:"服务器出错，请稍后再试",duration:3e3}))}catch(t){console.error(t),this.message="网络错误，请检查网络连接",I.Notification.error({title:"错误",message:"网络错误，请检查网络连接",duration:3e3})}},highlightKeyword(t){if(!this.keyword||!t)return t;const e=new RegExp(this.keyword,"gi");return t.replace(e,(t=>`<span class="highlight">${t}</span>`))},onInputChange(){this.keyword.trim()||(this.SouSuoarticles=[],this.message="请输入关键词进行搜索")},highlightButton(){this.isButtonHighlighted=!0},resetButton(){this.isButtonHighlighted=!1},CloseSearch(){this.SouSuoContent=!1},handleSearchClick(t){window.innerWidth<=768?(this.keyword.trim()&&this.searchArticles(),this.isSearchExpanded=!this.isSearchExpanded,this.isSearchExpanded&&this.$nextTick((()=>{const t=this.$el.querySelector(".input");t&&t.focus()}))):this.searchArticles()},toggleSearch(t){t.target.closest(".labelforsearch")||window.innerWidth<=768&&(this.isSearchExpanded||(this.isSearchExpanded=!0,this.$nextTick((()=>{const t=this.$el.querySelector(".input");t&&t.focus()}))))},handleDocumentClick(t){if(window.innerWidth<=768){const e=this.$el.querySelector(".InputContainer");e&&!e.contains(t.target)&&(this.isSearchExpanded=!1)}}},mounted(){this.isDisabled=!localStorage.getItem("token");const t=localStorage.getItem("theme")||"light";this.updateTheme(t),this.VuexloadFavorites(),this.fetchArticles(),this.setActiveSection(),this.fetchViewedArticles(),document.addEventListener("click",this.handleDocumentClick)},beforeDestroy(){document.removeEventListener("click",this.handleDocumentClick)}}),D=$,V=(0,u.A)(D,S,B,!1,null,"f2545c3e",null),P=V.exports,L=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-container"},[t.isLoading?t._e():e("div",{staticClass:"carousel-container"},[e("Carousel",{attrs:{"carousel-items":t.carouselItems}})],1),e("div",{staticClass:"card-container"},[e("transition",{attrs:{name:"fade"}},[t.isLoginForm?e("div",{staticClass:"card"},[e("div",{staticClass:"card-inner"},[e("div",{staticClass:"card-front"},[e("LoginForm",{attrs:{form:t.form,toggleForm:t.toggleForm}})],1)])]):t._e()]),e("transition",{attrs:{name:"fade"}},[t.isLoginForm?t._e():e("div",{staticClass:"card"},[e("div",{staticClass:"card-inner"},[e("div",{staticClass:"card-back"},[e("RegisterForm",{attrs:{form:t.form,toggleForm:t.toggleForm}})],1)])])])],1)])},H=[],T=function(){var t=this,e=t._self._c;return e("div",{staticClass:"swiper-container"},[e("div",{staticClass:"swiper-wrapper"},t._l(t.carouselItems,(function(i){return e("div",{key:i.id,staticClass:"swiper-slide"},[e("img",{staticClass:"slide-image",attrs:{src:i.src,alt:"Slide Image"}}),e("div",{staticClass:"quote"},[t._v(t._s(i.quote))]),e("div",{staticClass:"author"},[t._v(t._s(i.author))])])})),0),e("div",{staticClass:"swiper-pagination"})])},U=[],F=i(8961),E={props:{carouselItems:{type:Array,required:!0}},mounted(){new F.A(".swiper-container",{autoplay:{delay:3e3,disableOnInteraction:!1},loop:!0,pagination:{el:".swiper-pagination",clickable:!0,renderBullet:(t,e)=>`<span class="${e} custom-bullet"></span>`},allowTouchMove:!1})}},z=E,M=(0,u.A)(z,T,U,!1,null,"d497ab64",null),N=M.exports,q=function(){var t=this,e=t._self._c;return e("div",{staticClass:"form-container"},[e("h2",[t._v("Sign in")]),e("el-form",{ref:"loginForm",staticClass:"ElFrom",attrs:{model:t.form,rules:t.rules},on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[e("el-form-item",{attrs:{prop:"email"}},[e("el-input",{staticClass:"ElInp",attrs:{placeholder:"Email","prefix-icon":"el-icon-message"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),e("el-form-item",{attrs:{prop:"password"}},[e("el-input",{staticClass:"ElInp",attrs:{type:"password",placeholder:"Password","prefix-icon":"el-icon-lock","show-password":""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),e("el-button",{staticClass:"BtnAft",attrs:{type:"primary",loading:t.loading,block:""},on:{click:function(e){return t.submitForm("loginForm")}}},[t._v("登录")])],1),t._m(0),e("div",{staticClass:"signin-link"},[e("small",[t._v(" 没有账户? "),e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.toggleForm.apply(null,arguments)}}},[t._v("创建账户")])])])],1)},O=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"divider"},[e("span",{staticClass:"line"}),e("span",{staticClass:"text"},[t._v("or")]),e("span",{staticClass:"line"})])}],j={props:{toggleForm:{type:Function,required:!0}},data(){return{form:{email:"",password:""},rules:{email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能小于6个字符",trigger:"blur"}]},loading:!1,themes:{light:{"--primary-color":"#3498db","--ZiBaiBgc":"#f8f9ff","--ActiveBgc":"#f7f7f8","--background-color":"#ffffff","--Border":" #f0f1fb","--text-color":"#000000","--active-background-color":"#1988fa","--article-card-background-color":" #f5f5f5","--Business-card-gradient":"linear-gradient(to right, #1988fa 0%, #33c4f9 50%, #00f2fe 100%)"},dark:{"--primary-color":"#e74c3c","--ActiveBgc":"#1a1a1a","--ZiBaiBgc":"#1f1f1f","--background-color":"#000000","--Border":" #2c2c2c","--text-color":"#ecf0f1","--active-background-color":"#015aea","--article-card-background-color":" #212121","--Business-card-gradient":"linear-gradient(to right, #012a63, #015aea, #4d9ef7)"}}}},methods:{...(0,m.i0)(["updateUser"]),submitForm(t){this.$refs[t].validate((async t=>{if(!t)return!1;this.loading=!0;try{const t={email:this.form.email,password:this.form.password},e=await y.A.post("/api/auth/login",t,{headers:{"Content-Type":"application/json"}});I.Notification.success({title:"登录成功",message:"您已成功登录。",duration:3e3});const i=e.data.token;console.log("登陆后返回用户信息",e.data);const a=e.data.user;localStorage.setItem("token",i),console.log("登录处获得了信息",a),this.$store.dispatch("updateUser",{token:i,details:a}),y.A.get("/api/user",{headers:{Authorization:`Bearer ${i}`}}).then((t=>{console.log("登录处获得了信息",t);const e=t.data;this.$store.dispatch("updateUser",{token:i,details:e})})).catch((t=>{console.error("Get user details error:",t)})),this.$router.push("/Index")}catch(e){if(this.loading=!1,console.log(e),e.response&&e.response.data){const t=e.response.data.msg||"登录失败";I.Notification.error({title:"登录失败",message:t,duration:3e3})}else console.log(e),I.Notification.error({title:"登录失败",message:"登录过程中出现错误，请稍后重试。",duration:3e3})}}))},updateTheme(t){console.log(t),this.currentTheme=t;const e=this.themes[t];for(const i in e)document.documentElement.style.setProperty(i,e[i])}},mounted(){this.theme=localStorage.getItem("theme")||"light",console.log(this.theme),this.updateTheme(this.theme)}},R=j,Z=(0,u.A)(R,q,O,!1,null,"28bfe337",null),W=Z.exports,K=function(){var t=this,e=t._self._c;return e("div",{staticClass:"form-container2"},[e("h2",[t._v("Welcome back!")]),e("el-form",{ref:"registerForm",staticClass:"ElFrom",attrs:{model:t.form,rules:t.rules},on:{submit:function(e){return e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[e("el-form-item",{attrs:{prop:"name"}},[e("el-input",{staticClass:"ElInp",attrs:{placeholder:"用户名","prefix-icon":"el-icon-user"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("el-form-item",{attrs:{prop:"email"}},[e("el-input",{staticClass:"ElInp",attrs:{placeholder:"邮箱","prefix-icon":"el-icon-message"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),e("el-form-item",{attrs:{prop:"password"}},[e("el-input",{staticClass:"ElInp",attrs:{type:"password",placeholder:"密码","prefix-icon":"el-icon-lock","show-password":""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),e("el-form-item",{attrs:{prop:"confirmPassword"}},[e("el-input",{staticClass:"ElInp",attrs:{type:"password",placeholder:"再次输入密码","prefix-icon":"el-icon-lock","show-password":""},model:{value:t.form.confirmPassword,callback:function(e){t.$set(t.form,"confirmPassword",e)},expression:"form.confirmPassword"}})],1),e("el-button",{staticClass:"BtnAft",attrs:{type:"primary",loading:t.loading,block:""},on:{click:function(e){return t.submitForm("registerForm")}}},[t._v("创建帐户")])],1),t._m(0),e("div",{staticClass:"signin-link"},[e("small",[t._v(" 已经有账户了吗? "),e("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.toggleForm.apply(null,arguments)}}},[t._v("登陆")])])])],1)},Q=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"divider"},[e("span",{staticClass:"line"}),e("span",{staticClass:"text"},[t._v("or")]),e("span",{staticClass:"line"})])}],J={props:{toggleForm:{type:Function,required:!0},theme:{type:String,default:""}},data(){return{form:{name:"",email:"",password:"",confirmPassword:""},rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能小于6个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:(t,e,i)=>{e!==this.form.password?i(new Error("两次输入密码不一致")):i()},trigger:"blur"}]},loading:!1,themes:{light:{"--primary-color":"#3498db","--ZiBaiBgc":"#f8f9ff","--ActiveBgc":"#f7f7f8","--background-color":"#ffffff","--Border":"#f0f1fb","--text-color":"#000000","--active-background-color":"#1988fa","--article-card-background-color":"#f5f5f5","--Business-card-gradient":"linear-gradient(to right, #1988fa 0%, #33c4f9 50%, #00f2fe 100%)"},dark:{"--primary-color":"#e74c3c","--ActiveBgc":"#1a1a1a","--ZiBaiBgc":"#1f1f1f","--background-color":"#000000","--Border":"#2c2c2c","--text-color":"#ecf0f1","--active-background-color":"#015aea","--article-card-background-color":"#212121","--Business-card-gradient":"linear-gradient(to right, #012a63, #015aea, #4d9ef7)"}}}},methods:{submitForm(t){this.$refs[t].validate((async t=>{if(!t)return!1;this.loading=!0;try{const t={username:this.form.name,email:this.form.email,password:this.form.password};if(this.form.password!==this.form.confirmPassword)return void I.Notification.error({title:"注册失败",message:"密码和确认密码不匹配。",duration:3e3});const e=await y.A.post("/api/auth/register",t,{headers:{"Content-Type":"application/json"}});console.log(e.data),I.Notification.success({title:"注册成功",message:"您已经成功注册，请登录。",duration:3e3}),this.toggleForm()}catch(e){this.loading=!1,e.response&&e.response.data&&e.response.data.errors?e.response.data.errors.forEach((t=>{I.Notification.error({title:"注册失败",message:t.msg,duration:3e3})})):I.Notification.error({title:"注册失败",message:"注册过程中出现错误，请稍后重试。",duration:3e3})}}))},updateTheme(t){console.log(t),this.currentTheme=t;const e=this.themes[t];for(const i in e)document.documentElement.style.setProperty(i,e[i])}},mounted(){this.theme=localStorage.getItem("theme")||"light",console.log(this.theme),this.updateTheme(this.theme)}},G=J,Y=(0,u.A)(G,K,Q,!1,null,"3559f5fe",null),X=Y.exports,tt=i.p+"img/LunBoTuImg1.31d331e0.jpg",et=i.p+"img/LunBoTuImg2.0921403a.jpg",it=i.p+"img/LunBoTuImg3.287a6a48.jpg",at=i.p+"img/LunBoTuImg4.f02f1e54.jpg",st=i.p+"img/LunBoTuImg5.94bb15b8.jpg",rt={components:{Carousel:N,LoginForm:W,RegisterForm:X},data(){return{form:{country:"",phone:"",email:"",password:""},carouselItems:[{id:1,src:tt,quote:'"今天的努力，就是明天的光芒。"',author:"(Today's efforts are tomorrow's brilliance.)"},{id:2,src:et,quote:'"学习是一场永不止步的旅程。"',author:"(Learning is a never-ending journey.)"},{id:3,src:it,quote:'"成功不是偶然，而是日积月累。"',author:"(Success is not accidental, but accumulated day by day.)"},{id:4,src:at,quote:'"勇气不是没有恐惧，而是战胜恐惧。"',author:"(Courage is not the absence of fear, but the triumph over it.)"},{id:5,src:st,quote:'"每一个选择都是新的开始。"',author:"(Every choice is a new beginning.)"}],isLoginForm:!0}},methods:{toggleForm(){this.isLoginForm=!this.isLoginForm},showWelcomeNotification(){this.$nextTick((()=>{setTimeout((()=>{(0,I.Notification)({title:"Welcome!",message:"Welcome to our platform!",type:"info",duration:4e3,offset:20})}),2e3)}))}},mounted(){this.showWelcomeNotification()}},ot=rt,lt=(0,u.A)(ot,L,H,!1,null,"5af57424",null),nt=lt.exports,ct=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home-container"},[e("section",{staticClass:"featured-section"},[e("div",{staticClass:"featured-wrapper"},[e("div",{staticClass:"featured-background"},[e("img",{attrs:{src:t.getImageUrl(t.HomelatestArticle.coverImage,"uploads"),alt:"Featured Article"}}),e("div",{staticClass:"gradient-overlay"})]),e("div",{staticClass:"featured-content"},[e("div",{staticClass:"featured-text"},[e("router-link",{attrs:{to:{name:"Article",params:{id:t.HomelatestArticle._id||""}}}},[e("h1",{staticClass:"featured-title"},[t._v(t._s(t.HomelatestArticle.title||"No title available"))]),e("p",{staticClass:"featured-brief"},[t._v(t._s(t.HomelatestArticle.BriefIntroduction))]),e("div",{staticClass:"featured-meta"},[e("div",{staticClass:"featured-author"},[e("img",{attrs:{src:t.getImageUrl(t.SpecifyUserInformation.avatar,"UserImg"),alt:"作者头像"}}),e("span",[t._v(t._s(t.SpecifyUserInformation.username))])]),e("div",{staticClass:"featured-stats"},[e("span",[e("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(t.HomelatestArticle.viewCount||0))]),e("span",[e("i",{staticClass:"el-icon-star-off"}),t._v(" "+t._s(t.HomelatestArticle.favoriteCount||0))])])]),e("button",{staticClass:"read-more-btn"},[t._v(" 阅读全文 "),e("i",{staticClass:"el-icon-arrow-right"})])])],1)])])]),e("section",{staticClass:"categories-section"},[t._m(0),e("div",{staticClass:"categories-grid"},t._l(t.articleCategories,(function(i){return e("button",{key:i._id,staticClass:"category-card",class:{active:t.selectedCategory&&t.selectedCategory._id===i._id},on:{click:function(e){return t.filterArticlesByCategory(i)}}},[e("span",{staticClass:"category-name"},[t._v(t._s(i.name))]),e("span",{staticClass:"category-count"},[t._v(t._s(t.getCategoryCount(i)))])])})),0)]),e("section",{staticClass:"articles-section"},[t._m(1),t.IsDisplay?e("div",{staticClass:"empty-state"},[e("i",{staticClass:"el-icon-document"}),e("h3",[t._v("暂无文章")]),e("p",[t._v("快来发布你的第一篇文章吧！")])]):e("div",{staticClass:"articles-grid"},t._l(t.HomefilteredArticles,(function(i){return e("article",{key:i._id,staticClass:"article-card"},[e("router-link",{attrs:{to:{name:"Article",params:{id:i._id}}}},[e("div",{staticClass:"article-image"},[e("img",{attrs:{src:t.getImageUrl(i.coverImage,"uploads"),alt:"Article Image"}}),e("div",{staticClass:"article-overlay"},[e("span",{staticClass:"read-more"},[t._v("阅读更多")])])]),e("div",{staticClass:"article-content"},[e("div",{staticClass:"article-meta"},[e("span",{staticClass:"article-category"},[t._v(t._s(t.getArticleCategories(i)))]),e("span",{staticClass:"article-date"},[t._v(t._s(t.formatDate(i.createdAt)))])]),e("h3",{staticClass:"article-title"},[t._v(t._s(i.title))]),e("p",{staticClass:"article-description"},[t._v(t._s(i.BriefIntroduction))]),e("div",{staticClass:"article-footer"},[e("div",{staticClass:"article-author"},[e("img",{attrs:{src:t.getImageUrl(t.getUser.avatar,"UserImg"),alt:"作者头像"}}),e("span",[t._v(t._s(i.authorName))])]),e("div",{staticClass:"article-stats"},[e("span",[e("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(i.viewCount||0))]),e("span",[e("i",{staticClass:"el-icon-star-off"}),t._v(" "+t._s(i.favoriteCount||0))])])])])])],1)})),0)])])},dt=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"section-header"},[e("h2",[t._v("探索分类")]),e("p",[t._v("发现你感兴趣的内容")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"section-header"},[e("h2",[t._v("最新文章")]),e("p",[t._v("发现更多精彩内容")])])}],ut={components:{},data(){return{articles:[],IsDisplay:null,Homearticles:[],HomefilteredArticles:[],HomelatestArticle:{},SpecifyUserInformation:"",articleCategories:[],allactive:{_id:"all",name:"全部"},selectedCategory:{_id:"all",name:"全部"},UserColl:[]}},computed:{...(0,m.L8)(["isLoggedIn","getUser"])},methods:{async fetchCategories(){try{const t=await y.A.get("/api/categories");this.articleCategories=t.data,console.log("文章分类",this.articleCategories),this.articleCategories.unshift(this.allactive),this.articleCategories.length>0&&(this.selectedCategory=this.articleCategories[0],this.filterArticlesByCategory(this.selectedCategory))}catch(t){console.error("Error fetching categories:",t)}},filterArticlesByCategory(t){this.selectedCategory=t,"全部"===t.name?(this.IsDisplay=!1,this.HomefilteredArticles=this.Homearticles,console.log("获取到全部分类的文章",this.HomefilteredArticles)):(this.HomefilteredArticles=this.Homearticles.filter((e=>Array.isArray(e.categories)?e.categories.some((e=>(e.name||e)===t.name)):e.categories===t.name)),0===this.HomefilteredArticles.length?this.IsDisplay=!0:this.IsDisplay=!1)},getImageUrl(t,e="uploads"){if(!t)return null;const i=!1;let a;return a=i?`http://localhost:3000/${e}/${t}`:`${window.location.origin}/${e}/${t}`,a},async HomefetchArticles(){try{const t=await y.A.get("/api/articles");if(this.Homearticles=t.data,console.log("储存文章的列表",this.Homearticles),this.HomefilteredArticles=this.Homearticles,this.HomelatestArticle=this.Homearticles.length>0?this.Homearticles[this.Homearticles.length-1]:{},console.log("文章的所有属性",this.HomelatestArticle),void 0==this.HomelatestArticle.user)return;this.getUserImgOrObject(this.HomelatestArticle.user)}catch(t){console.error("Error fetching articles:",t)}},async getUserImgOrObject(t){try{const e=await y.A.get(`/api/public-user-info/${t}`);return this.SpecifyUserInformation=e.data,e.data}catch(e){console.error("获取特定用户信息失败:",e)}},async loadFavorites(){if(!localStorage.getItem("token"))return;const t=await y.A.get("/api/user",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),e=t.data._id;try{const t=await y.A.get(`/api/favorites/${e}`);this.favorites=t.data,this.UserColl=this.favorites,console.log("在持久化中获取到用户的收藏记录",this.UserColl)}catch(i){console.error("加载收藏失败:",i)}},getCategoryCount(t){return"全部"===t.name?this.Homearticles.length:this.Homearticles.filter((e=>Array.isArray(e.categories)?e.categories.some((e=>(e.name||e)===t.name)):e.categories===t.name)).length},getArticleCategories(t){return t&&t.categories?"string"===typeof t.categories?t.categories:Array.isArray(t.categories)?t.categories.map((t=>t.name||t)).join(", "):"":""},formatDate(t){return t?new Date(t).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}):""}},created(){this.selectedCategory={_id:"all",name:"全部"},this.loadFavorites(),this.HomefetchArticles(),this.fetchCategories()},mounted(){},beforeCreate(){},beforeMount(){},beforeUpdate(){},updated(){},beforeDestroy(){},destroyed(){},activated(){}},gt=ut,ht=(0,u.A)(gt,ct,dt,!1,null,"ff3dbb6e",null),mt=ht.exports,pt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"categories-page"},[e("section",{staticClass:"latest-article-section"},[e("div",{staticClass:"latest-article-wrapper"},[e("div",{staticClass:"latest-article-content"},[e("router-link",{attrs:{to:{name:"Article",params:{id:t.categorieslatestArticles[0]?._id||""}}}},[e("span",{staticClass:"article-label"},[t._v("最新文章")]),e("h1",{staticClass:"article-title"},[t._v(t._s(t.categorieslatestArticles[0]?.title||"暂无文章"))]),e("p",{staticClass:"article-brief"},[t._v(t._s(t.categorieslatestArticles[0]?.BriefIntroduction))]),e("div",{staticClass:"article-meta"},[e("div",{staticClass:"article-author"},[e("img",{attrs:{src:t.getImageUrl(t.authorAvatars[t.categorieslatestArticles[0]?.user],"UserImg"),alt:"作者头像"}}),e("span",[t._v(t._s(t.categorieslatestArticles[0]?.authorName))])]),e("div",{staticClass:"article-stats"},[e("span",[e("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(t.categorieslatestArticles[0]?.viewCount||0))]),e("span",[e("i",{staticClass:"el-icon-star-off"}),t._v(" "+t._s(t.categorieslatestArticles[0]?.favoriteCount||0))])])])])],1),e("div",{staticClass:"latest-article-image"},[e("img",{attrs:{src:t.getImageUrl(t.categorieslatestArticles[0]?.coverImage,"uploads"),alt:"最新文章封面"}}),e("div",{staticClass:"image-overlay"})])])]),e("section",{staticClass:"articles-section"},[e("div",{staticClass:"section-header"},[e("h2",[t._v("所有文章")]),e("div",{staticClass:"section-filters"},[e("el-select",{attrs:{placeholder:"选择分类",clearable:""},on:{change:t.handleCategoryChange},model:{value:t.selectedCategory,callback:function(e){t.selectedCategory=e},expression:"selectedCategory"}},[e("el-option",{attrs:{label:"全部",value:""}}),t._l(t.categories,(function(i){return e("el-option",{key:i._id,attrs:{label:i.name,value:i._id}},[e("span",{staticClass:"category-option"},[e("i",{class:t.getCategoryIcon(i.name)}),e("span",{staticClass:"category-name"},[t._v(t._s(i.name))])])])}))],2)],1)]),e("div",{staticClass:"articles-grid"},[t.isLoading?e("div",{staticClass:"loading-state"},[e("i",{staticClass:"el-icon-loading"}),e("p",[t._v("加载中...")])]):t.error?e("div",{staticClass:"error-state"},[e("i",{staticClass:"el-icon-warning"}),e("p",[t._v(t._s(t.error))])]):t._l(t.filteredArticles,(function(i){return e("article",{key:i._id,staticClass:"article-card"},[e("router-link",{attrs:{to:{name:"Article",params:{id:i._id}}}},[e("div",{staticClass:"article-image"},[e("img",{attrs:{src:t.getImageUrl(i.coverImage,"uploads"),alt:"文章封面"}}),e("div",{staticClass:"article-overlay"},[e("span",{staticClass:"read-more"},[t._v("阅读更多")])])]),e("div",{staticClass:"article-content"},[e("div",{staticClass:"article-meta"},[e("span",{staticClass:"article-category"},[t._v(t._s(t.getArticleCategories(i)))]),e("span",{staticClass:"article-date"},[t._v(t._s(t.formatDate(i.createdAt)))])]),e("h3",{staticClass:"article-title"},[t._v(t._s(i.title))]),e("p",{staticClass:"article-description"},[t._v(t._s(i.BriefIntroduction))]),e("div",{staticClass:"article-footer"},[e("div",{staticClass:"article-author"},[e("img",{attrs:{src:t.getImageUrl(t.authorAvatars[i.user],"UserImg"),alt:"作者头像"}}),e("span",[t._v(t._s(i.authorName))])]),e("div",{staticClass:"article-stats"},[e("span",[e("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(i.viewCount||0))]),e("span",[e("i",{staticClass:"el-icon-star-off"}),t._v(" "+t._s(i.favoriteCount||0))])])])])]),e("div",{staticClass:"article-actions"},[t.userInformation?e("span",{staticClass:"favorite-button",on:{click:function(e){return e.stopPropagation(),t.toggleFavorite(i._id)}}},[e("i",{class:i.isFavorite?"el-icon-star-on":"el-icon-star-off"})]):t._e()])],1)}))],2),e("div",{staticClass:"pagination-wrapper"},[e("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.categoriesarticles.length,"page-size":t.pageSize,"current-page":t.currentPage},on:{"current-change":t.handlePageChange}})],1)])])},ft=[],vt={data(){return{categoriesarticles:[],categorieslatestArticles:[],authorAvatars:{},userInformation:"",currentPage:1,pageSize:5,favorites:[],isLoading:!1,error:null,selectedCategory:"",categories:[]}},components:{},computed:{paginatedArticles(){const t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.filteredArticles.slice(t,e)},filteredArticles(){return this.selectedCategory?this.categoriesarticles.filter((t=>t.categories&&t.categories.some((t=>t._id===this.selectedCategory)))):this.categoriesarticles}},watch:{},methods:{...(0,m.i0)(["VuexloadFavorites"]),getImageUrl(t,e="uploads"){if(!t)return null;const i=!1;let a;return a=i?`http://localhost:3000/${e}/${t}`:`${window.location.origin}/${e}/${t}`,a},async categoriesfetchArticles(){this.isLoading=!0,this.error=null;try{const t=await y.A.get("/api/articles");this.categoriesarticles=t.data,this.categorieslatestArticles=this.categoriesarticles.slice(-1),await Promise.all(this.categoriesarticles.map((t=>t.user?this.fetchAuthorAvatar(t.user):Promise.resolve())))}catch(t){this.error="加载文章失败，请稍后重试",console.error("Error fetching articles:",t)}finally{this.isLoading=!1}},async fetchAuthorAvatar(t){try{const e=await y.A.get(`/api/public-user-info/${t}`);this.$set(this.authorAvatars,t,e.data.avatar)}catch(e){console.error("Error fetching user avatar:",e)}},handlePageChange(t){this.currentPage=t},async getuser(){if(!localStorage.getItem("token"))return;const t=await y.A.get("/api/user",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});this.userInformation=t.data._id},async toggleFavorite(t){const e=this.userInformation;try{const i=await y.A.get(`/api/favorites/${e}/${t}`);console.log("打印从后台获取回来的状态",i);const a=i.data;if(console.log("打印了收藏状态",a),a){await y.A.delete("/api/favorites",{data:{userId:e,articleId:t}}),this.$notify({title:"收藏",message:"取消收藏",type:"warning"});const i=this.categoriesarticles.find((e=>e._id===t));i&&(i.isFavorite=!1),this.VuexloadFavorites()}else{await y.A.post("/api/favorites",{userId:e,articleId:t});const i=this.categoriesarticles.find((e=>e._id===t));this.$notify({title:"收藏",message:"收藏成功",type:"success"}),console.log("收藏成功"),i&&(i.isFavorite=!0),this.VuexloadFavorites()}}catch(i){console.error("请求失败:",i)}},async loadFavorites(){if(console.log("调用了loadFavorites"),!localStorage.getItem("token"))return;const t=await y.A.get("/api/user",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),e=t.data._id;try{const t=await y.A.get(`/api/favorites/${e}`);if(this.favorites=t.data,console.log("在持久化中获取到用户的收藏记录",this.favorites),!Array.isArray(this.favorites))return void console.error("返回的收藏数据不是数组",this.favorites);this.categoriesarticles.forEach((t=>{t.isFavorite=this.favorites.some((e=>String(e.articleId._id)===String(t._id)))}))}catch(i){console.error("加载收藏失败:",i)}},formatDate(t){return t?new Date(t).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}):""},getArticleCategories(t){return t.categories?t.categories.map((t=>t.name)).join(", "):""},async fetchCategories(){try{const t=await y.A.get("/api/categories");this.categories=t.data}catch(t){console.error("Error fetching categories:",t)}},getCategoryIcon(t){const e={"技术":"el-icon-cpu","生活":"el-icon-coffee-cup","笔记":"el-icon-notebook-2","分享":"el-icon-share","其他":"el-icon-more"};return e[t]||"el-icon-folder"},handleCategoryChange(){this.currentPage=1}},created(){this.getuser(),this.loadFavorites(),this.categoriesfetchArticles(),this.fetchCategories()}},Ct=vt,wt=(0,u.A)(Ct,pt,ft,!1,null,"dee9819e",null),yt=wt.exports,_t=function(){var t=this,e=t._self._c;return e("div",{staticClass:"upload-article-container"},[e("el-form",{ref:"uploadForm",attrs:{model:t.formData,rules:t.rules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"标题名称",prop:"title"}},[e("el-input",{attrs:{placeholder:"请输入标题"},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),e("el-form-item",{attrs:{label:"简介",prop:"BriefIntroduction"}},[e("el-input",{attrs:{type:"textarea",placeholder:"请输入简介",rows:"4"},model:{value:t.formData.BriefIntroduction,callback:function(e){t.$set(t.formData,"BriefIntroduction",e)},expression:"formData.BriefIntroduction"}})],1),e("el-form-item",{attrs:{label:"文章内容",prop:"content"}},[e("quill-editor",{staticClass:"quill-editor",attrs:{options:t.editorOptions},model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}})],1),e("el-form-item",{attrs:{label:"选择分类",prop:"categories"}},[e("el-select",{staticClass:"category-select",staticStyle:{width:"100%"},attrs:{placeholder:"请选择分类",multiple:!1},model:{value:t.formData.categories,callback:function(e){t.$set(t.formData,"categories",e)},expression:"formData.categories"}},t._l(t.categories,(function(i){return e("el-option",{key:i._id,attrs:{label:i.name,value:i._id}},[e("span",{staticClass:"category-option"},[e("i",{class:t.getCategoryIcon(i.name)}),e("span",{staticClass:"category-name"},[t._v(t._s(i.name))]),e("span",{staticClass:"category-desc"},[t._v(t._s(i.description))])])])})),1)],1),e("el-form-item",{attrs:{label:"上传封面图片",prop:"articleImage"}},[e("el-upload",{staticClass:"upload-demo",attrs:{action:"","file-list":t.fileList,"on-change":t.handleFileUpload,"auto-upload":!1,limit:1,"on-exceed":t.handleExceed}},[e("el-button",[t._v("点击上传图片")]),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传一张封面图片")])],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.saveContent}},[t._v("保存内容")])],1)],1)],1)},bt=[],At=(i(6762),i(8731)),kt=i.n(At),It=(i(4209),{data(){return{formData:{title:"",BriefIntroduction:"",content:"",categories:"",coverImage:null},rules:{title:[{required:!0,message:"请输入标题名称",trigger:"blur"}],BriefIntroduction:[{required:!0,message:"请输入简介",trigger:"blur"}],categories:[{required:!0,message:"请选择分类",trigger:"change"}],content:[{required:!0,message:"请输入文章内容",trigger:"blur"}]},categories:[],fileList:[],editorOptions:{theme:"snow",modules:{toolbar:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["clean"],["image"]]}}}},created(){this.fetchCategories()},methods:{async fetchCategories(){try{const t=await y.A.get("/api/categories");this.categories=t.data}catch(t){console.error("Error fetching categories:",t),this.categories=defaultCategories}},getCategoryIcon(t){const e={"技术":"el-icon-cpu","生活":"el-icon-coffee-cup","笔记":"el-icon-notebook-2","分享":"el-icon-share","其他":"el-icon-more"};return e[t]||"el-icon-folder"},handleExceed(t,e){this.$message.warning("只能上传一张封面图片")},handleFileUpload(t,e){e.length>1&&e.splice(0,1),this.formData.coverImage=t.raw,this.fileList=e},saveContent(){this.$refs.uploadForm.validate((async t=>{if(!t)return;const e=new FormData;Object.keys(this.formData).forEach((t=>{e.append(t,this.formData[t])}));for(let a of e.entries());try{const t=localStorage.getItem("token");await y.A.post("/api/articles",e,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"multipart/form-data"}});I.Notification.success({title:"成功",message:"文章保存成功"})}catch(i){let t="文章保存失败";i.response&&i.response.data&&(t=i.response.data.message||i.response.data.msg||t),I.Notification.error({title:"保存失败",message:t,duration:3e3}),console.error("文章保存失败:",i.response||i)}}))}}}),xt=It,St=(0,u.A)(xt,_t,bt,!1,null,null,null),Bt=St.exports,$t=i(2042),Dt=function(){var t=this,e=t._self._c;return e("div",{ref:"articleBox",staticClass:"articleBox"},[e("div",{staticClass:"header"},[e("button",{staticClass:"back-button",on:{click:t.goBack}},[t._v("←")]),e("span",{staticClass:"separator"},[t._v("/")]),e("span",{staticClass:"title"},[t._v(t._s(t.article?.title))])]),t.article?e("div",{staticClass:"articleText"},[e("div",{staticClass:"articleImgTle"},[e("div",{staticClass:"img-container"},[e("img",{staticClass:"article-image",attrs:{src:t.getRandomImage(),alt:"Random Image"}}),e("div",{staticClass:"overlay"},[e("span",{staticClass:"title"},[t._v(t._s(t.article?.title))]),e("p",[t._v(t._s(t.article.BriefIntroduction))]),e("p",{staticClass:"article-author"},[e("strong",[t._v("作者 : ")]),t._v(" "+t._s(t.article.authorName))])])])]),e("div",{staticClass:"articleContent"},[e("div",{staticClass:"articletextS",domProps:{innerHTML:t._s(t.article.content)}})])]):e("div",[e("p",[t._v("Loading...")])]),e("section",{staticClass:"comment-section"},[e("h2",[t._v("评论")]),e("div",{staticClass:"comment-input"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newComment,expression:"newComment"}],attrs:{placeholder:"写下你的评论..."},domProps:{value:t.newComment},on:{input:function(e){e.target.composing||(t.newComment=e.target.value)}}}),e("button",{on:{click:t.submitComment}},[t._v("提交评论")])]),0!==t.comments.length?e("div",{staticClass:"comments-list"},[e("h3",[t._v("最新评论")]),t._l(t.comments,(function(i){return e("div",{key:i._id,staticClass:"comment"},[e("p",[t._v(t._s(i.content))]),i.author&&i.createdAt?e("small",[t._v(" 来自："+t._s(i.author.username)+" · "+t._s(new Date(i.createdAt).toLocaleString())+" ")]):e("small",[t._v(" Unknown author · Unknown date ")]),i.replies&&i.replies.length?e("div",{staticClass:"replies"},t._l(i.replies,(function(i){return e("div",{key:i._id,staticClass:"reply"},[e("p",[t._v(t._s(i.content))]),i.author&&i.createdAt?e("small",[t._v(" 来自： "+t._s(i.author.username)+" · "+t._s(new Date(i.createdAt).toLocaleString())+" ")]):e("small",[t._v(" Unknown author · Unknown date ")])])})),0):t._e(),e("button",{on:{click:function(e){return t.replyToComment(i._id)}}},[t._v("回复")]),t.replyingTo===i._id?e("div",{staticClass:"reply-form"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.replyContent,expression:"replyContent"}],attrs:{placeholder:"输入回复内容..."},domProps:{value:t.replyContent},on:{input:function(e){e.target.composing||(t.replyContent=e.target.value)}}}),e("button",{on:{click:function(e){return t.submitReply(i._id)}}},[t._v("提交")]),e("button",{on:{click:t.cancelReply}},[t._v("取消")])]):t._e()])}))],2):e("div")])])},Vt=[],Pt={data(){return{newComment:"",comments:[],article:null,replyingTo:null,replyContent:"",progressBarWidth:0,scrollPosition:0,articleBoxHeight:0,acid:"",images:[{src:i(9123)},{src:i(3060)}],themes:{light:{"--primary-color":"#3498db","--ZiBaiBgc":"#f8f9ff","--ActiveBgc":"#f7f7f8","--background-color":"#ffffff","--Border":" #f0f1fb","--text-color":"#000000","--active-background-color":"#1988fa","--article-card-background-color":" #f5f5f5","--Business-card-gradient":"linear-gradient(to right, #1988fa 0%, #33c4f9 50%, #00f2fe 100%)"},dark:{"--primary-color":"#e74c3c","--ActiveBgc":"#1a1a1a","--ZiBaiBgc":"#1f1f1f","--background-color":"#000000","--Border":" #2c2c2c","--text-color":"#ecf0f1","--active-background-color":"#015aea","--article-card-background-color":" #212121","--Business-card-gradient":"linear-gradient(to right, #012a63, #015aea, #4d9ef7)"}}}},created(){const t=this.$route.params.id;this.acid=t,this.fetchComments(t),this.fetchArticleData()},mounted(){const t=localStorage.getItem("theme")||"light";this.updateTheme(t),console.log("本地储存状态",t),this.$nextTick((()=>{this.handleScroll(),window.addEventListener("scroll",this.handleScroll)})),this.getLastViewedArticle().then((t=>{setTimeout((()=>{null!==t&&window.scrollTo({top:t,behavior:"smooth"})}),100)})),window.addEventListener("scroll",this.handleScroll)},computed:{},beforeDestroy(){const t=this.$refs.articleBox;t&&t.removeEventListener("scroll",this.handleScroll),this.saveScrollPosition(),console.log("退出成功"),window.removeEventListener("resize",this.handleResize)},methods:{goBack(){window.history.length>1?this.$router.go(-1):this.$router.push("/Index/Home")},updateTheme(t){console.log(t),this.currentTheme=t;const e=this.themes[t];for(const i in e)document.documentElement.style.setProperty(i,e[i]);localStorage.setItem("theme",t)},handleScroll(){const t=this.$refs.articleBox;t&&(this.scrollPosition=window.scrollY,this.articleBoxHeight=t.clientHeight)},async getLastViewedArticle(){if(!localStorage.getItem("token"))return null;console.log("token存在"),console.log(localStorage.getItem("token"));try{const t=await y.A.get(`/api/user/last-viewed/${this.acid}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});return t.data.scrollPosition}catch(t){return console.error("Error retrieving last viewed article:",t),null}},async saveScrollPosition(){if(!localStorage.getItem("token"))return;console.log(this.articleBoxHeight),console.log(window.innerHeight);const t=this.articleBoxHeight-window.innerHeight;console.log("最大宽度",t);try{await y.A.post("/api/user/save-progress",{articleId:this.acid,scrollPosition:this.scrollPosition,maxScrollPosition:t},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})}catch(e){console.error("Error saving scroll position:",e)}},handleResize(){const t=this.$refs.articleBox;t.style.height=`${window.innerHeight}px`},goBack(){window.history.length>1?this.$router.go(-1):this.$router.push("/Index/Home")},getRandomImage(){const t=Math.floor(Math.random()*this.images.length);return this.images[t].src},async fetchArticleData(){try{const t=this.$route.params.id,e=await y.A.get(`/api/articles/${t}`);this.article=e.data}catch(t){console.error("Error fetching article data:",t)}},replyToComment(t){this.replyingTo=t,this.replyContent=""},cancelReply(){this.replyingTo=null,this.replyContent=""},async submitComment(){if(this.newComment.trim())try{const t=await y.A.post("/api/comments",{content:this.newComment,articleId:this.acid,author:this.user},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});this.newComment="",this.comments.push(t.data.comment)}catch(t){console.error("Error submitting comment:",t)}else alert("评论内容不能为空")},async submitReply(t){if(this.replyContent.trim())try{await y.A.post("/api/comments/reply",{content:this.replyContent,articleId:this.article._id,parentCommentId:t},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),this.fetchComments(this.article._id),this.replyingTo=null,this.replyContent=""}catch(e){console.error("Error submitting reply:",e)}else alert("回复内容不能为空")},async fetchComments(t){try{console.log(t);const e=await y.A.get(`/api/comments/${t}/comments`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log("报错后"),this.comments=e.data.comments,console.log(this.comments)}catch(e){console.error("Error fetching comments:",e)}}}},Lt=Pt,Ht=(0,u.A)(Lt,Dt,Vt,!1,null,"08d7822a",null),Tt=Ht.exports,Ut=function(){var t=this,e=t._self._c;return e("div",{staticClass:"user-page"},[e("div",{staticClass:"user-header"},[e("div",{staticClass:"user-banner"},[e("img",{attrs:{src:i(9123),alt:"banner"}}),e("div",{staticClass:"user-avatar"},[e("img",{attrs:{src:t.getImageUrl(t.user.avatar,"UserImg"),alt:"头像"},on:{click:t.openDialog}})])]),e("div",{staticClass:"user-info"},[e("h2",[t._v(t._s(t.user.username))]),e("p",[t._v(t._s(t.user.email))]),e("el-button",{attrs:{type:"primary"},on:{click:t.LU_logout}},[t._v("退出登录")])],1)]),e("div",{staticClass:"user-content"},[e("div",{staticClass:"user-sidebar"},[e("el-card",{staticClass:"statistics-card"},[e("div",{staticClass:"stat-item"},[e("div",{staticClass:"stat-value"},[t._v(t._s(t.totalViews))]),e("div",{staticClass:"stat-label"},[t._v("浏览量")])]),e("div",{staticClass:"stat-item"},[e("div",{staticClass:"stat-value"},[t._v(t._s(t.userArticles.length))]),e("div",{staticClass:"stat-label"},[t._v("文章数")])])]),e("el-card",{staticClass:"menu-card"},[e("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"已发布",name:"first"}},[e("div",{staticClass:"tab-content"},[t.userArticles&&t.userArticles.length>0?e("div",{staticClass:"articles-list"},t._l(t.userArticles,(function(i){return e("div",{key:i._id,staticClass:"article-item"},[e("router-link",{attrs:{to:{name:"Article",params:{id:i._id}}}},[e("div",{staticClass:"article-content"},[i.coverImage?e("img",{attrs:{src:t.getImageUrl(i.coverImage,"uploads"),alt:"封面图片"}}):t._e(),e("div",{staticClass:"article-info"},[e("h4",[t._v(t._s(i.title))]),e("p",[t._v(t._s(i.BriefIntroduction||"暂无简介"))]),e("div",{staticClass:"article-meta"},[e("span",[e("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(i.viewCount||0))]),e("span",[e("i",{staticClass:"el-icon-star-off"}),t._v(" "+t._s(i.favoriteCount||0))]),e("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(e){return e.preventDefault(),t.confirmDelete(i._id)}}},[t._v("删除")])],1)])])])],1)})),0):e("div",{staticClass:"no-data"},[t._v("暂无发布文章")])])]),e("el-tab-pane",{attrs:{label:"收藏",name:"second"}},[e("div",{staticClass:"tab-content"},[t.favorites&&t.favorites.length>0?e("div",{staticClass:"favorites-list"},t._l(t.favorites,(function(i){return e("div",{key:i.articleId?._id||i._id,staticClass:"article-item"},[i.articleId?._id?e("router-link",{attrs:{to:{name:"Article",params:{id:i.articleId._id}}}},[e("div",{staticClass:"article-content"},[i.articleId?.coverImage?e("img",{attrs:{src:t.getImageUrl(i.articleId.coverImage,"uploads"),alt:"封面图片"}}):t._e(),e("div",{staticClass:"article-info"},[e("h4",[t._v(t._s(i.articleId?.title||"未知标题"))]),e("p",[t._v(t._s(i.articleId?.BriefIntroduction||"暂无简介"))]),e("div",{staticClass:"article-meta"},[e("span",[e("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(i.articleId?.viewCount||0))]),e("span",[e("i",{staticClass:"el-icon-star-off"}),t._v(" "+t._s(i.articleId?.favoriteCount||0))]),e("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-star-off"},on:{click:function(e){return e.preventDefault(),t.confirmUnfavorite(i._id)}}},[t._v("取消收藏")])],1)])])]):t._e()],1)})),0):e("div",{staticClass:"no-data"},[t._v("暂无收藏文章")])])])],1)],1)],1),e("div",{staticClass:"user-main"},[e("el-card",{staticClass:"recent-view-card"},[e("div",{attrs:{slot:"header"},slot:"header"},[e("span",[t._v("最近浏览")])]),t.viewedArticles&&t.viewedArticles.length>0?e("div",{staticClass:"recent-view-content"},t._l(t.viewedArticles,(function(i){return e("div",{key:i.articleId,staticClass:"article-item"},[e("router-link",{attrs:{to:{name:"Article",params:{id:i.articleId}}}},[e("div",{staticClass:"article-content"},[i.coverImage?e("img",{attrs:{src:t.getImageUrl(i.coverImage,"uploads"),alt:"封面图片"}}):t._e(),e("div",{staticClass:"article-info article-info-title"},[e("h4",[t._v(t._s(i.title||"未知标题"))]),e("div",{staticClass:"article-meta"},[e("span",[e("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(i.viewCount||0))]),e("span",[e("i",{staticClass:"el-icon-star-off"}),t._v(" "+t._s(i.favoriteCount||0))]),e("span",{staticClass:"reading-progress"},[e("el-progress",{staticClass:"custom-progress",attrs:{percentage:t.calculateProgress(i.scrollPosition,i.maxScrollPosition),format:t=>`已读${t}%`,"stroke-width":18,"show-text":!0,color:["#67C23A","#E6A23C","#F56C6C"],"text-inside":!0}})],1),e("span",{staticClass:"view-time"},[t._v(t._s(new Date(i.lastViewedAt).toLocaleString()))])])])])])],1)})),0):e("div",{staticClass:"no-data"},[t._v("暂无浏览记录")])])],1)]),e("el-dialog",{attrs:{title:"修改头像",visible:t.dialogVisible,width:"300px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-upload",{attrs:{action:"/api/update-avatar",headers:t.headers,name:"avatar","list-type":"picture-card","on-success":t.handleSuccess,"on-error":t.handleError}},[e("i",{staticClass:"el-icon-plus"})]),e("p",[t._v("点击上传新的头像")]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")])],1)],1),e("el-dialog",{attrs:{title:"确认删除",visible:t.deleteDialogVisible,width:"30%"},on:{"update:visible":function(e){t.deleteDialogVisible=e}}},[e("span",[t._v("确定要删除这篇文章吗？此操作不可恢复。")]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.deleteDialogVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"danger"},on:{click:t.deleteArticle}},[t._v("确定")])],1)]),e("el-dialog",{attrs:{title:"确认取消收藏",visible:t.unfavoriteDialogVisible,width:"30%"},on:{"update:visible":function(e){t.unfavoriteDialogVisible=e}}},[e("span",[t._v("确定要取消收藏这篇文章吗？")]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.unfavoriteDialogVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"warning"},on:{click:t.unfavoriteArticle}},[t._v("确定")])],1)])],1)},Ft=[],Et={data(){return{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},user:"",dialogVisible:!1,deleteDialogVisible:!1,unfavoriteDialogVisible:!1,articleToDelete:null,favoriteToRemove:null,favorites:[],userArticles:[],viewedArticles:[],isMobile:!1,activeName:"first",totalViews:0}},props:{lastViewedArticleZi:{type:Object}},computed:{...(0,m.L8)(["getUser","isLoggedIn"])},created(){this.user=this.getUser,console.log("用户是",this.user)},methods:{LU_logout(){this.$emit("call-parent")},getImageUrl(t,e){if(!t)return null;const i=window.location.origin,a="UserImg"===e?`UserImg/${t}`:`uploads/${t}`,s=new URL(a,i);return console.log("拼接后的请求路径是",s.toString()),s.toString()},openDialog(){this.dialogVisible=!0},handleSuccess(t,e){this.$message.success("头像上传成功！"),this.dialogVisible=!1},handleError(t){this.$message.error("头像上传失败，请重试！")},confirmDelete(t){this.articleToDelete=t,this.deleteDialogVisible=!0},async deleteArticle(){try{await y.A.delete(`/api/articles/${this.articleToDelete}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),this.$message.success("文章删除成功"),this.deleteDialogVisible=!1,this.loadUserArticles()}catch(t){console.error("删除文章失败:",t),this.$message.error("删除文章失败，请重试")}},confirmUnfavorite(t){this.favoriteToRemove=t,this.unfavoriteDialogVisible=!0},async unfavoriteArticle(){try{const t=this.user._id,e=this.favorites.find((t=>t._id===this.favoriteToRemove))?.articleId?._id;if(!t||!e)throw new Error("无效的用户ID或文章ID");await y.A.delete("/api/favorites",{data:{userId:t,articleId:e}}),this.$notify({title:"收藏",message:"取消收藏",type:"warning"}),this.unfavoriteDialogVisible=!1,this.loadFavorites()}catch(t){console.error("取消收藏失败:",t),this.$message.error("取消收藏失败，请重试")}},async loadUserArticles(){try{if(!this.user._id)return;const t=await y.A.get(`/api/users/${this.user._id}/articles`);this.userArticles=t.data,console.log("获取到用户的文章列表：",this.userArticles)}catch(t){console.error("加载用户文章失败:",t),this.$message.error("加载文章列表失败")}},async loadFavorites(){if(!localStorage.getItem("token"))return;const t=await y.A.get("/api/user",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),e=t.data._id;try{const t=await y.A.get(`/api/favorites/${e}`);this.favorites=t.data,console.log("在持久化中获取到用户的收藏记录",this.favorites)}catch(i){console.error("加载收藏失败:",i)}},async loadTotalViews(){try{if(!this.user._id)return;const t=await y.A.get(`/api/users/${this.user._id}/total-views`);this.totalViews=t.data.totalViews,console.log("获取到用户文章总浏览量：",this.totalViews)}catch(t){console.error("加载总浏览量失败:",t),this.$message.error("加载总浏览量失败")}},async loadViewedArticles(){try{const t=await y.A.get("/api/user/viewed-articles",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});this.viewedArticles=t.data.sort(((t,e)=>new Date(e.lastViewedAt)-new Date(t.lastViewedAt))),console.log("获取到用户的浏览记录：",this.viewedArticles)}catch(t){console.error("加载浏览记录失败:",t),this.$message.error("加载浏览记录失败")}},calculateProgress(t,e){if(!e)return 0;const i=t/e*100;return Math.min(Math.round(i),100)}},mounted(){console.log("最近浏览的文章数据：",this.lastViewedArticleZi),console.log("用户是",this.user),this.loadFavorites(),this.loadUserArticles(),this.loadTotalViews(),this.loadViewedArticles()}},zt=Et,Mt=(0,u.A)(zt,Ut,Ft,!1,null,"691a04b5",null),Nt=Mt.exports,qt=i(7966);function Ot(){const t=localStorage.getItem("token");if(!t)return!0;try{const e=(0,qt.s)(t),i=Math.floor(Date.now()/1e3);return e.exp<i}catch(e){return console.error("Token decoding failed:",e),!0}}w["default"].use(x()),w["default"].use($t.Ay);const jt=[{path:"/",redirect:"/Index"},{path:"/Index",component:P,name:"Index",meta:{requiresAuth:!0},children:[{path:"",redirect:"home"},{path:"home",component:mt,name:"Home",meta:{requiresAuth:!0}},{path:"discover",component:yt,name:"Discover",meta:{requiresAuth:!0}},{path:"create",component:Bt,name:"Create",meta:{requiresAuth:!0},beforeEnter:(t,e,i)=>{const a=localStorage.getItem("token");a&&i()}},{path:"my",component:Nt,name:"My",meta:{requiresAuth:!0}}]},{path:"/Login",component:nt,name:"Login"},{path:"/Article/:id",name:"Article",component:Tt,meta:{requiresAuth:!0}}],Rt=new $t.Ay({mode:"history",routes:jt});Rt.beforeEach(((t,e,i)=>{"Article"===t.name&&localStorage.setItem("articleFrom",e.fullPath),i()})),Rt.beforeEach(((t,e,i)=>{const a=localStorage.getItem("token");console.log("前置路由守卫",a),t.matched.some((t=>t.meta.requiresAuth))&&(!a||Ot())?(console.log("token 过期"),I.Notification.error({title:"登录信息已失效",message:"请从新登录",duration:3e3}),localStorage.removeItem("token"),i("/Login")):i()}));var Zt=Rt,Wt=i(7187),Kt=i.n(Wt),Qt=(i(9432),i(6868)),Jt=i(7080),Gt=i(5307);window.$=window.jQuery=s();const Yt=new(Kt()),Xt={apiKey:"AIzaSyDqbqz4CpsCTDY0VbWPQB-t6uHdEIQk2TQ",authDomain:"myblog-c17a0.firebaseapp.com",databaseURL:"https://myblog-c17a0-default-rtdb.firebaseio.com",projectId:"myblog-c17a0",storageBucket:"myblog-c17a0.appspot.com",messagingSenderId:"710118595739",appId:"1:710118595739:web:84343f79d7ad946326ba3e",measurementId:"G-RXB7NMBMLE"},te=(0,Qt.Wp)(Xt),ee=(0,Jt.xI)(te),ie=(0,Gt.C3)(te),ae=localStorage.getItem("token");ae&&(b.dispatch("updateUser",{token:ae,details:{}}),y.A.get("/api/user",{headers:{Authorization:`Bearer ${ae}`}}).then((t=>{const e=t.data;b.dispatch("updateUser",{token:ae,details:e})})).catch((t=>{console.error("Fetch user details error:",t)}))),w["default"].prototype.$firebaseApp=te,w["default"].prototype.$auth=ee,w["default"].prototype.$database=ie;const se=new w["default"]({router:Zt,vuetify:Yt,store:b,data:{$firebaseAuth:ee},render:t=>t(C)});w["default"].component("VueCal",kt()),w["default"].config.productionTip=!1,w["default"].use(x()),w["default"].use(k()),se.$mount("#app")},9123:function(t,e,i){t.exports=i.p+"img/1.80955ccd.jpg"},3060:function(t,e,i){t.exports=i.p+"img/2.470bd5d7.jpg"},3153:function(t,e,i){t.exports=i.p+"img/logo.0f30f6e6.png"}},e={};function i(a){var s=e[a];if(void 0!==s)return s.exports;var r=e[a]={id:a,loaded:!1,exports:{}};return t[a].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}i.m=t,function(){i.amdO={}}(),function(){var t=[];i.O=function(e,a,s,r){if(!a){var o=1/0;for(d=0;d<t.length;d++){a=t[d][0],s=t[d][1],r=t[d][2];for(var l=!0,n=0;n<a.length;n++)(!1&r||o>=r)&&Object.keys(i.O).every((function(t){return i.O[t](a[n])}))?a.splice(n--,1):(l=!1,r<o&&(o=r));if(l){t.splice(d--,1);var c=s();void 0!==c&&(e=c)}}return e}r=r||0;for(var d=t.length;d>0&&t[d-1][2]>r;d--)t[d]=t[d-1];t[d]=[a,s,r]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var a in e)i.o(e,a)&&!i.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){i.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){i.p="/"}(),function(){var t={524:0};i.O.j=function(e){return 0===t[e]};var e=function(e,a){var s,r,o=a[0],l=a[1],n=a[2],c=0;if(o.some((function(e){return 0!==t[e]}))){for(s in l)i.o(l,s)&&(i.m[s]=l[s]);if(n)var d=n(i)}for(e&&e(a);c<o.length;c++)r=o[c],i.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return i.O(d)},a=self["webpackChunknewcxdblog"]=self["webpackChunknewcxdblog"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=i.O(void 0,[504],(function(){return i(6365)}));a=i.O(a)})();
//# sourceMappingURL=app.d8d042b5.js.map